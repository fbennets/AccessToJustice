# Open Decision - Telegram Bot

Open Decision is an Open-Source Decision Automation System, that is optimized for legal processes. The system will be used to build a platform to provide free legal advice for consumers.

Try the Telegram Bot [here](t.me/opendecision_bot).

**This is the Telegram chatbot/interpreter to display decision trees generated by the Open Decision builder. For the main project, go [here](https://github.com/fbennets/open-decision).**


Further information about the project on www.open-decision.org

## Table of content
- [Getting Started](#getting-started)
    - [Set-up a VPS & start your bot](#set-up-a-vps--start-your-bot)
    - [Use your own builder instance](#use-your-own-builder-instance)
    - [Provide a demo ](#provide-a-demo )
- [Known Issues](#known-issues)
- [Built with](#built-with)
- [Contributing](#contributing)
- [License](#license)
- [Links](#links)


## Getting Started
The Telegram bot hosted by the [Open Decision project](https://open-decision.org) using the handle [@opendecision_bot](t.me/opendecision_bot) can display any tree generated using the hosted builder at [builder.open-decision.org](builder.open-decision.org).   
If you want to host your own bot to (1) display decision trees from the hosted builder with your own branding or (2) want to display trees from a self-hosted instance of Open Decision, follow this tutorial.

The bot can display trees, that have been published using the Open Decision builder. It uses the unique identifier (like 'habbizvzxt') to load a tree from the builder using a get request.

The current bot version is not production-ready and only for testing purposes.

### Set-up a VPS & start your bot
You need to set up a Virtual Private Server (VPS) to run the bot. There are plenty of tutorials online.  
Take a look at the  [hoster list](https://github.com/python-telegram-bot/python-telegram-bot/wiki/Where-to-host-Telegram-Bots) for some suggestions on where to host your bot. From our experience, [Uberspace](https://uberspace.de/en/) is awesome to get your bot up and running quickly.

Use SSH to get a shell on you VPS and clone this repository using:
```
git clone https://github.com/fbennets/Open-Decision-Telegram-Bot.git bot
```
Next install the requirements.

```bash
# Install dependencies
cd bot
pip install -r requirements.txt
```
Afterwards, you need create a Telegram bot account and get the API key. To do so, talk to the [Botfather](https://t.me/botfather) on Telegram and follow the instructions. For more information, [see here](https://core.telegram.org/bots#6-botfather).  
Then, you need to set your API token as an environment variable. Enter this in your shell:
```bash
export OD_BOT_TOKEN=YourTokenHere

# The command should look like this:
# export OD_BOT_TOKEN=644739147:AAGMPo-Jz3mKRnHRTnrPEDi7jUF1vqNOD5k
```
Great, now you can start your bot using:
``` bash
python od-telegram-bot.py

#If Python 3 is not your default version, try:
python od-telegram-bot.py
```

For a more detailed tutorial on how to deploy the bot, [see here](https://github.com/python-telegram-bot/python-telegram-bot/wiki/Hosting-your-bot).  

If you leave the shell, your bot will usually stop working. To prevent this, use a terminal multiplexer like screen. [See here](https://github.com/python-telegram-bot/python-telegram-bot/wiki/Hosting-your-bot#start-your-bot) for more information.

### Use your own builder instance
If you want to use your self-hosted instance of the Open Decision builder, you need to set the callback URL to your custom domain.
```bash
export OD_BOT_URL=https://YourDomain.com
#By default, the bot uses https://builder.open-decision.org
```
### Provide a demo
You can provide a demo-tree for your bot. When users start a conversation with your bot, they can choose to see a demo query.  
You can find the identifier of your published tree in the "Published Trees" section in the builder or in the URL of a published tree.
```bash
export OD_BOT_DEMO_QUERY=YourTreeIdentifier
#URL of the published tree: https://builder.open-decision.org/publish/habbizvzxt/
#Example command: export OD_BOT_DEMO_QUERY=habbizvzxt
```
## Known Issues
- Slow answers: Depending on your server speed, the bot answers quite slowly. The bot is currently not production ready. The bot mode will be switched from polling to webhook soon, to increase the speed.

## Built with
- Python-Telegram-Bot
- JSONlogic


## Contributing

Please read [CONTRIBUTING.md](https://github.com/fbennets/open-decision/blob/master/CONTRIBUTING.md) for details on our code of conduct, and the process for submitting pull requests to us.

## License

This project is licensed under the MIT License - see the [LICENSE](https://github.com/fbennets/open-decision/blob/master/LICENSE) file for details.

## Links

* [Project Website](http://open-decision.org)
* [Open Decision Builder](https://github.com/fbennets/open-decision)
